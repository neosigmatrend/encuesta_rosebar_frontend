<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Encuesta Rose Bar</title>
  <style>
    body { font-family: Arial; max-width: 400px; margin: 50px auto; }
    input, button { width: 100%; padding: 10px; margin: 10px 0; }
  </style>
</head>
<body>
  <h2>üçª Encuesta Rose Bar</h2>
  <form id="encuesta">
    <input type="text" id="nombre" placeholder="Tu nombre" required />
    //<input type="text" id="area" placeholder="√Årea de trabajo" required />
    <select id="area" required>
      <option value="">Seleccione un √°rea</option>
      <option value="Administraci√≥n">Administraci√≥n</option>
      <option value="Barra">Bar</option>
      <option value="Cocina">Cocina</option>
      <option value="Coper√≠a">Mesas</option>
      <option value="Sal√≥n">Seguridad</option>
      <option value="Supervisi√≥n">Gerencia</option>
    </select>
    
    <input type="hidden" id="ip" />
    <button type="submit">Enviar</button>
  </form>
  <div id="estado"></div>

  <script>
    // Obtener IP p√∫blica del cliente
    fetch('https://api.ipify.org?format=json')
      .then(res => res.json())
      .then(data => {
        document.getElementById("ip").value = data.ip;
      });

    // Enviar datos al backend
    document.getElementById("encuesta").addEventListener("submit", function(e) {
      e.preventDefault();

      const payload = {
        nombre: document.getElementById("nombre").value,
        area: document.getElementById("area").value,
        ip: document.getElementById("ip").value
      };

      fetch("https://encuesta-api-rosebar.onrender.com", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(res => res.text())
      .then(txt => {
        document.getElementById("estado").innerText = "‚úÖ ¬°Gracias! Tu respuesta fue enviada.";
        document.getElementById("encuesta").reset();
      })
      .catch(err => {
        document.getElementById("estado").innerText = "‚ùå Error al enviar. Intenta m√°s tarde.";
      });
    });
  </script>
</body>
</html>

